- name: "Shared: Check system status"
  request:
    path: /status
    method: GET
  expect:
    - status: 200
      json:
        shape:
          status: string
          version: string

- name: "Shared: Verify authentication"
  request:
    path: /auth/verify
    method: GET
  expect:
    - status: 200

- name: "Shared: Get user profile"
  request:
    path: /me
    method: GET
  store:
    user_id: "{{ response.body.id }}"
    user_email: "{{ response.body.email }}"

- name: "Shared: Nested workflow section"
  steps:
    - name: "Fetch settings"
      request:
        path: /settings
        method: GET

    - name: "Update preferences"
      request:
        path: /settings/preferences
        method: PUT
        json:
          theme: "dark"
