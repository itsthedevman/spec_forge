# =============================================================================
# Factory Reference Structure Definition
# =============================================================================
# Defines the structure for referencing factories within blueprints.
# Factory references allow inline factory usage with custom attributes
# and build strategies.
#
# Example usage in blueprints:
#   factories.user:
#     attributes:
#       role: "admin"
#     strategy: build
# =============================================================================

traits:
  type: array
  default: []
  aliases:
    - trait
  description: |-
    FactoryBot traits to apply to this factory invocation.
    Traits are defined in the factory file and modify the built object.
    Multiple traits can be combined and are applied in order.
  examples:
    - "[admin]"
    - "[admin, verified]"

attributes:
  type: hash
  default: {}
  description: |-
    Attribute overrides for this specific factory invocation.
    Merged with the factory's default attributes. Supports variable
    interpolation and faker data generation.
  examples:
    - |-
      attributes:
        name: "Custom Name"
        email: "custom@test.com"
    - |-
      attributes:
        role: "{{ user_role }}"
        active: true

build_strategy:
  type: string
  default: create
  aliases:
    - strategy
  description: |-
    The FactoryBot build strategy to use. Determines whether records
    are persisted to the database or just built in memory.
    - create: Persists to database (default) - use for integration tests
    - build: Builds without saving - use when testing logic, not persistence
    - build_stubbed: Builds with stubbed ID - fastest, use for unit tests
      that don't need DB interaction
  examples:
    - "create"
    - "build"
    - "build_stubbed"

size:
  type: integer
  default: 0
  aliases:
    - count
  transformer: abs
  description: |-
    Number of records to create. When 0 (default), creates a single
    record. When > 0, creates that many records and returns an array.
    Useful for testing list endpoints or batch operations.
  examples:
    - 0
    - 5
    - 100
